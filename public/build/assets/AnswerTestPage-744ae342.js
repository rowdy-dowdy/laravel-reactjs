import{q as y,r as n,a as v,j as s,p as k,I as S}from"./main-ea3bcec7.js";import{u as q}from"./test-2110aa97.js";import{P as T}from"./prism.min-7ec26ca3.js";const D=()=>{const{code:c,id:i}=y(),[e,t]=n.useState(!0),{findHistory:a}=q(),[o,h]=n.useState([]),[m,p]=n.useState([]),[x,u]=n.useState(null),[l,w]=n.useState(null),{user:j}=v(),f=async r=>{r.preventDefault(),!(typeof window>"u")&&await k({successTitle:"Đã sao chép",callback:async()=>{navigator.clipboard.writeText(window.location.href)}})};return n.useEffect(()=>{(async()=>{if(!c||!i)return;const{test:N,history:d}=await a(c,i);if(u(N),w(d),d){const{questions:b}=await S(`/api/test-history/${d.id}/questions`).catch($=>({questions:[]})),g=JSON.parse(d.answers);h(b),p(g)}t(!1)})()},[]),e?s.jsx("p",{className:"text-center p-2",children:"Đang tải..."}):!x||!l||!j?s.jsx("p",{className:"text-center p-2",children:"Không tải được"}):s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("div",{className:"flex-none w-96",children:s.jsxs("div",{className:"rounded-lg bg-white shadow sticky top-0",children:[s.jsxs("p",{className:"text-xl font-semibold p-3 border-b",children:["Điểm:    ",l.point,"/10"]}),s.jsx("div",{className:"p-3",children:s.jsxs("div",{className:"rounded border",children:[s.jsx("p",{className:"p-2 bg-gray-200",children:"Thông tin chi tiết"}),s.jsxs("div",{className:"px-2 py-3 flex flex-col space-y-2",children:[s.jsxs("p",{children:["Trắc nghiệm: ",l.correct," (",m.filter(r=>r.answer).length,"/",l.correct+l.wrong," câu)"]}),s.jsx("a",{href:"#",className:"text-blue-600",onClick:f,children:"copy link gửi giáo viên"})]})]})})]})}),s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:"sticky -top-4 rounded-lg bg-white p-3 shadow text-center font-semibold",children:x.title}),s.jsx("div",{className:"rounded-lg bg-white p-3 shadow mt-4",children:s.jsx(C,{answers:m,questions:o})})]})]})},C=({answers:c,questions:i})=>(n.useEffect(()=>{T.highlightAll()}),s.jsx("div",{className:"flex flex-col space-y-4",children:c.map((e,t)=>{const a=i.find(o=>o.id==e.questionId);return a?s.jsxs("div",{className:"w-full rounded-md bg-white shadow",children:[s.jsxs("div",{className:"p-4",children:[s.jsxs("span",{className:"font-semibold",children:["Câu ",t+1,". "]}),s.jsx("div",{className:"content mt-2",dangerouslySetInnerHTML:{__html:a.content}})]}),s.jsxs("div",{className:"flex flex-wrap -mx-2 p-4",children:[s.jsxs("div",{className:"w-1/2 sm:w-1/4 px-2 mb-4",children:[s.jsx("span",{className:"font-semibold",children:"A. "}),s.jsx("span",{className:"break-words",children:a.a})]}),s.jsxs("div",{className:"w-1/2 sm:w-1/4 px-2 mb-4",children:[s.jsx("span",{className:"font-semibold",children:"B. "}),s.jsx("span",{className:"break-words",children:a.b})]}),s.jsxs("div",{className:"w-1/2 sm:w-1/4 px-2 mb-4",children:[s.jsx("span",{className:"font-semibold",children:"C. "}),s.jsx("span",{className:"break-words",children:a.c})]}),s.jsxs("div",{className:"w-1/2 sm:w-1/4 px-2 mb-4",children:[s.jsx("span",{className:"font-semibold",children:"D. "}),s.jsx("span",{className:"break-words",children:a.d})]})]}),s.jsxs("div",{className:"px-4 py-1.5 rounded-b-md flex items-center justify-end space-x-2",children:[s.jsx("span",{className:`font-semibold mr-4 text-lg
            ${e.answer==null?"":e.correct?"text-green-600":"text-red-600"}
          `,children:e.answer==null?"":e.correct?"Đúng":"Sai"}),s.jsx("p",{className:`p-2 px-4 ${e.answer=="a"?"rounded bg-yellow-600 text-white":""}`,children:s.jsx("span",{className:"font-semibold",children:"A"})}),s.jsx("p",{className:`p-2 px-4 ${e.answer=="b"?"rounded bg-yellow-600 text-white":""}`,children:s.jsx("span",{className:"font-semibold",children:"B"})}),s.jsx("p",{className:`p-2 px-4 ${e.answer=="c"?"rounded bg-yellow-600 text-white":""}`,children:s.jsx("span",{className:"font-semibold",children:"C"})}),s.jsx("p",{className:`p-2 px-4 ${e.answer=="d"?"rounded bg-yellow-600 text-white":""}`,children:s.jsx("span",{className:"font-semibold",children:"D"})})]})]},t):s.jsx("div",{className:"w-full rounded-md bg-white shadow",children:s.jsxs("div",{className:"p-4",children:[s.jsxs("span",{className:"font-semibold",children:["Câu ",t+1,". "]}),s.jsx("div",{className:"content mt-2",children:"Câu hỏi không còn tồn tại"})]})},t)})}));export{D as default};
